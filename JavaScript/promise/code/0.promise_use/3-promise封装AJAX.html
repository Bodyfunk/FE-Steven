<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>3-promise封装AJAX</title>
	</head>
	<body>
		<script>
			// 接口地址： https://api.apiopen.top/getJoke

			const p = new Promise((resolve, reject) => {
				// 创建AJAX请求
				// 1. 创建对象
				const xhr = new XMLHttpRequest();

				// 2. 初始化
				xhr.open("GET", "https://api.apiopen.top/getJoke");

				// 3. 发送
				xhr.send();

				// 4. 绑定事件，处理响应
				xhr.onreadystatechange = function () {
					// 判断
					if (xhr.readyState === 4) {
						if (xhr.status >= 200 && xhr.status < 300) {
							// 表示成功
							// console.log(xhr.response)
							// resolve(xhr.status)
							resolve(xhr.response);
						} else {
							// 如果失败
							// console.error(xhr.status)
							xhr.reject(err);
						}
					}
				};
			});

			p.then(
				function (value) {
					console.log(value);
				},
				function (err) {
					console.error(errr);
				}
			);
		</script>
	</body>
</html>
